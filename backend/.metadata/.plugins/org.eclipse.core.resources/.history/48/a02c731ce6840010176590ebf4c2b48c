package com.wipro.userms.util;

package com.wipro.userms.util;

import java.util.Date;

import org.springframework.stereotype.Component;

import io.jsonwebtoken.Jwts;

@Component
public class JwtUtil {
	public String generateToken(String userId, int userType) {
		return Jwts.builder()
				.setSubject(userId)
				.claim("role", userType == 0 ? "ROLE_ADMIN" : "ROLE_USER")
				.setIssuedAt(new Date())
				.setExpiration(new Date(System.currentTimeMillis() + AppConstant.EXPIRATION_TIME))
				.signWith(io.jsonwebtoken.security.Keys.hmacShaKeyFor(AppConstant.SECRET_KEY.getBytes()))
				.compact();
	}

	public String extractUserId(String token) {
		return Jwts.parserBuilder()
				.setSigningKey(AppConstant.SECRET_KEY.getBytes())
				.build()
				.parseClaimsJws(token)
				.getBody()
				.getSubject();
	}

	public String extractRole(String token) {
		return Jwts.parserBuilder()
				.setSigningKey(AppConstant.SECRET_KEY.getBytes())
				.build()
				.parseClaimsJws(token)
				.getBody()
				.get("role", String.class);
	}
}